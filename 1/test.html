<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>மாதிரித் தேர்வு - TNPSC வழிகாட்டி</title>
    
    <link rel="shortcut icon" href="assets/img/logo/logo.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Tamil:wght@400;500;700&family=Noto+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="assets/css/style.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

 
</head>
<body>
    <header>
        <div class="nav-info"><h5><i class="fas fa-bullhorn"></i>டி.என்.பி.எஸ்.சி படிப்பு மையம்</h5></div>
        <nav class="navbar"><div class="container"> <a href="index.html" class="navbar-logo"><img src="assets/img/logo/logo.png" class="logo_img" alt="Logo"></a><ul class="navbar-links"><div class="mobile-menu-header"><h3 class="mobile-menu-logo"><img src="assets/img/logo/logo.png" class="logo_img" alt="Logo"></h3><i class="fas fa-times mobile-menu-close"></i></div><li><a href="index.html">முகப்பு</a></li><li><a href="exam.html" class="active">தேர்வுகள்</a></li><li><a href="books.html">கையேடு</a></li><li><a href="exam-info.html">அறிக்கைகள்</a></li><li><a href="plan.html">அட்டவணை</a></li></ul><div class="navbar-auth"><i class="fas fa-user-circle profile-icon mobile-view-none"></i><i class="fas fa-bars mobile-menu-icon"></i></div></div></nav>
    </header>

    <main>
        <section class="test-section">
            <div class="test-container">
                <div class="test-header">
                    <h2>பொதுத் தமிழ் - மாதிரித் தேர்வு 1</h2>
                    <div id="question-counter"></div>
                </div>

                <div id="questions-container"></div>

                <div class="pagination-controls">
                    <button id="prev-btn" class="pagination-btn"><i class="fas fa-arrow-left"></i> முந்தைய பக்கம்</button>
                    <button id="next-btn" class="pagination-btn">அடுத்த பக்கம் <i class="fas fa-arrow-right"></i></button>
                    <button id="submit-btn" class="submit-btn" style="display: none;">தேர்வை சமர்ப்பி</button>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer-section"> <div class="container footer-grid"> <div class="footer-col"> <h3 class="footer-logo">TNPSC வழிகாட்டி</h3> <p>அரசுப் பணி கனவை நனவாக்க மாணவர்களுக்கு தரமான பயிற்சி மற்றும் மாதிரித் தேர்வுகளை வழங்குவதே எங்கள் நோக்கம்.</p> <div class="footer-socials"> <a href="#"><i class="fab fa-facebook-f"></i></a> <a href="#"><i class="fab fa-youtube"></i></a> <a href="#"><i class="fab fa-telegram-plane"></i></a> <a href="#"><i class="fab fa-whatsapp"></i></a> </div> </div> <div class="footer-col"> <h4>முக்கிய இணைப்புகள்</h4> <ul> <li><a href="#">எங்களை பற்றி</a></li> <li><a href="#">அனைத்து தேர்வுகள்</a></li> <li><a href="#">என் கணக்கு</a></li> <li><a href="#">வலைப்பதிவு</a></li> <li><a href="#">தொடர்பு</a></li> </ul> </div> <div class="footer-col"> <h4>தேர்வுகள்</h4> <ul> <li><a href="#">Group 1</a></li> <li><a href="#">Group 2/2A</a></li> <li><a href="#">Group 4</a></li> <li><a href="#">பொதுத் தமிழ்</a></li> <li><a href="#">கணிதம்</a></li> </ul> </div> <div class="footer-col"> <h4>சந்தா செலுத்து</h4> <p>புதிய தேர்வு அறிவிப்புகளை உங்கள் மின்னஞ்சலில் பெறுங்கள்.</p> <form class="footer-subscribe-form"> <input type="email" placeholder="உங்கள் மின்னஞ்சல்"> <button type="submit"><i class="fas fa-paper-plane"></i></button> </form> </div> </div> <div class="footer-bottom"> <p>&copy; 2025 TNPSC வழிகாட்டி. அனைத்து உரிமைகளும் பாதுகாக்கப்பட்டவை.</p> </div> </footer>

    <div id="fixed-timer">
        <div id="timer-setup">
            <!-- இந்த பொத்தான் இப்போது தேவையில்லை, ஆனால் நேரத்தைத் தேர்வு செய்ய இது இங்கே வைக்கப்பட்டுள்ளது -->
            <span style="font-weight: bold; margin-right: 10px;">நேரம்:</span>
            <div id="timer-options-group">
                <button class="timer-option-btn active" data-time="30">30நி</button>
                <button class="timer-option-btn" data-time="60">60நி</button>
                <button class="timer-option-btn" data-time="90">90நி</button>
            </div>
        </div>

        <div id="timer-running">
            <i class="fas fa-stopwatch"></i>
            <span id="timer">30:00</span>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        
        const allQuestions = [
            { question: "'யாதும் ஊரே யாவரும் கேளிர்' என்ற கூற்று யாருடையது?", options: ["கணியன் பூங்குன்றனார்", "திருவள்ளுவர்", "கம்பர்", "ஔவையார்"], correctAnswer: 0 },
            { question: "சிலப்பதிகாரத்தின் ஆசிரியர் யார்?", options: ["சீத்தலைச் சாத்தனார்", "இளங்கோவடிகள்", "திருத்தக்க தேவர்", "நாதகுத்தனார்"], correctAnswer: 1 },
            { question: "பத்துப்பாட்டு நூல்களில் மிகவும் பெரியது எது?", options: ["குறிஞ்சிப்பாட்டு", "முல்லைப்பாட்டு", "மதுரைக்காஞ்சி", "பட்டினப்பாலை"], correctAnswer: 2 },
            { question: "'திராவிட மொழிகளின் ஒப்பிலக்கணம்' என்ற நூலை எழுதியவர்?", options: ["ஜி.யு. போப்", "கால்டுவெல்", "வீரமாமுனிவர்", "பரிதிமாற் கலைஞர்"], correctAnswer: 1 },
            { question: "குண்டலகேசி எந்த சமயத்தைச் சார்ந்த நூல்?", options: ["சைவம்", "வைணவம்", "பௌத்தம்", "சமணம்"], correctAnswer: 2 },
            { question: "தமிழ் மொழியின் முதல் இலக்கண நூல் எது?", options: ["நன்னூல்", "தொல்காப்பியம்", "அகத்தியம்", "யாப்பருங்கலக்காரிகை"], correctAnswer: 1 },
            { question: "கம்பராமாயணத்தில் எத்தனை காண்டங்கள் உள்ளன?", options: ["ஐந்து", "ஆறு", "ஏழு", "எட்டு"], correctAnswer: 1 },
            { question: "பதினெண் கீழ்க்கணக்கு நூல்களில் உள்ள ஒரே தொகைநூல் எது?", options: ["திருக்குறள்", "நாலடியார்", "நான்மணிக்கடிகை", "பழமொழி நானூறு"], correctAnswer: 0 },
            { question: "சீவக சிந்தாமணியின் பாட்டுடைத் தலைவன் யார்?", options: ["கோவலன்", "சீவகன்", "ராமன்", "நளன்"], correctAnswer: 1 },
            { question: "முல்லைத் திணையின் தெய்வம் எது?", options: ["முருகன்", "இந்திரன்", "திருமால்", "வருணன்"], correctAnswer: 2 },
            { question: "பதினொன்றாம் திருமுறையில் சேர்க்கப்பட்டுள்ள ஒரே பெண் ஆழ்வார்?", options: ["ஆண்டாள்", "காரைக்கால் அம்மையார்", "ஔவையார்", "காக்கை பாடினியார்"], correctAnswer: 1 },
            { question: "'நாடகமேத்தும் நாடகக் கணிகை' எனப்படுபவள் யார்?", options: ["கண்ணகி", "மாதவி", "மணிமேகலை", "சுதமதி"], correctAnswer: 1 },
            { question: "குறிஞ்சி நில மக்களின் முக்கிய தொழில் என்ன?", options: ["மீன் பிடித்தல்", "நிரை மேய்த்தல்", "வேட்டையாடுதல்", "உழவு செய்தல்"], correctAnswer: 2 },
            { question: "நற்றிணைப் பாடல்களின் அடிவரையறை என்ன?", options: ["4-8 அடி", "3-6 அடி", "13-31 அடி", "9-12 அடி"], correctAnswer: 3 },
            { question: "'உண்டாலம்ம இவ்வுலகம்' என்ற புறநானூற்றுப் பாடலைப் பாடியவர்?", options: ["பரணர்", "கபிலர்", "கடலுள் மாய்ந்த இளம் பெருவழுதி", "மோசிகீரனார்"], correctAnswer: 2 },
            { question: "தமிழ் தாத்தா என அழைக்கப்படுபவர் யார்?", options: ["பரிதிமாற் கலைஞர்", "மறைமலையடிகள்", "தெ.பொ.மீனாட்சிசுந்தரம்", "உ.வே.சாமிநாதையர்"], correctAnswer: 3 },
            { question: "திருக்குறளில் உள்ள மொத்த அதிகாரங்களின் எண்ணிக்கை?", options: ["133", "1330", "100", "150"], correctAnswer: 0 },
            { question: "'மனோன்மணீயம்' என்ற நாடக நூலின் ஆசிரியர்?", options: ["சுந்தரம் பிள்ளை", "பம்மல் சம்பந்த முதலியார்", "தி.க. சண்முகம்", "சங்கரதாஸ் சுவாமிகள்"], correctAnswer: 0 },
            { question: "ஐஞ்சிறுங்காப்பியங்களில் பொருந்தாதது எது?", options: ["சூளாமணி", "யசோதர காவியம்", "நீலகேசி", "வளையாபதி"], correctAnswer: 3 },
            { question: "'விடியல்' என்ற புனைப்பெயரில் எழுதியவர் யார்?", options: ["புதுமைப்பித்தன்", "ஜெயகாந்தன்", "கல்கி", "சுஜாதா"], correctAnswer: 3 },
            { question: "சரியான சந்திப்பிழையை நீக்கிய தொடரைத் தேர்ந்தெடு.", options: ["பூப் பறித்தாள்", "பூ பறித்தாள்", "பூப்பறித்தாள்", "பூவை பறித்தாள்"], correctAnswer: 2 },
            { question: "பிரித்தெழுதுக: 'செந்தமிழ்'", options: ["செம் + தமிழ்", "செந் + தமிழ்", "செம்மை + தமிழ்", "செ + தமிழ்"], correctAnswer: 2 },
            { question: "ஆங்கிலச் சொல்லுக்கு நேரான தமிழ்ச்சொல்: 'Aesthetics'", options: ["கலையியல்", "அழகியல்", "ஒப்பனையியல்", "ஓவியவியல்"], correctAnswer: 1 },
            { question: "நான்காம் தமிழ்ச்சங்கம் எங்கு நிறுவப்பட்டது?", options: ["சென்னை", "மதுரை", "தஞ்சாவூர்", "திருச்சி"], correctAnswer: 1 },
            { question: "பொருந்தாச் சொல்லைக் கண்டறிக:", options: ["கார்", "கூதிர்", "முன்பனி", "வேனில்"], correctAnswer: 3 }, 
            { question: "ஒருமை பன்மை பிழையற்ற தொடர் எது?", options: ["அவர்கள் வந்தான்", "அவன் வந்தார்கள்", "அவை வந்தன", "அது வந்தன"], correctAnswer: 2 },
            { question: "'மலைக்கள்ளன்' என்ற நூலின் ஆசிரியர்?", options: ["கல்கி", "அறிஞர் அண்ணா", "நாமக்கல் கவிஞர்", "பாரதிதாசன்"], correctAnswer: 2 },
            { question: "செய்யுளிசை அளபெடைக்கு மற்றொரு பெயர் என்ன?", options: ["சொல்லிசை அளபெடை", "இன்னிசை அளபெடை", "ஒற்றளபெடை", "இசைநிறை அளபெடை"], correctAnswer: 3 },
            { question: "அகர வரிசைப்படி சொற்களை சீர் செய்க:", options: ["சங்கு, சீப்பு, செடி, சோறு", "செடி, சங்கு, சீப்பு, சோறு", "சங்கு, செடி, சோறு, சீப்பு", "சீப்பு, செடி, சங்கு, சோறு"], correctAnswer: 0 },
            { question: "பல்லவர் கால சிற்பக்கலைக்கு சிறந்த சான்று?", options: ["தஞ்சை பெரிய கோவில்", "மாமல்லபுரம்", "கங்கை கொண்ட சோழபுரம்", "சிதம்பரம் நடராஜர் கோவில்"], correctAnswer: 1 }
        ];

        let currentPage = 1;
        const questionsPerPage = 10;
        const totalQuestions = allQuestions.length;
        const totalPages = Math.ceil(totalQuestions / questionsPerPage);
        let userAnswers = new Array(totalQuestions).fill(null);
        let timerInterval;
        let isTestSubmitted = false;
        let selectedDuration = 30; // Default duration
        let isTestStarted = false; // **புதிய மாறி: தேர்வு தொடங்கிவிட்டதா என்பதைக் கண்காணிக்க**

        const questionsContainer = document.getElementById('questions-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const timerDisplay = document.getElementById('timer');
        const questionCounterDisplay = document.getElementById('question-counter');
        const testSection = document.querySelector('.test-section');
        
        const timerSetup = document.getElementById('timer-setup');
        const timerRunning = document.getElementById('timer-running');
        const timerOptionsGroup = document.getElementById('timer-options-group');

        function displayQuestions() {
            questionsContainer.innerHTML = '';
            const startIndex = (currentPage - 1) * questionsPerPage;
            const endIndex = startIndex + questionsPerPage;
            const questionsForPage = allQuestions.slice(startIndex, endIndex);
            
            questionCounterDisplay.textContent = `கேள்விகள் ${startIndex + 1} - ${Math.min(endIndex, totalQuestions)} / ${totalQuestions}`;

            questionsForPage.forEach((q, index) => {
                const questionIndex = startIndex + index;
                const questionItem = document.createElement('div');
                questionItem.className = 'question-item';

                let optionsHTML = '<ul class="options-list">';
                q.options.forEach((option, optionIndex) => {
                    const isChecked = userAnswers[questionIndex] === optionIndex ? 'checked' : '';
                    optionsHTML += `
                        <li>
                            <input type="radio" id="q${questionIndex}_opt${optionIndex}" name="q${questionIndex}" value="${optionIndex}" ${isChecked}>
                            <label for="q${questionIndex}_opt${optionIndex}">${option}</label>
                        </li>
                    `;
                });
                optionsHTML += '</ul>';

                questionItem.innerHTML = `
                    <p class="question-text"><span>கேள்வி ${questionIndex + 1}:</span>${q.question}</p>
                    ${optionsHTML}
                `;
                questionsContainer.appendChild(questionItem);
            });

            updatePaginationButtons();
            attachAnswerListeners();
        }

        function updatePaginationButtons() {
            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages;
            submitBtn.style.display = currentPage === totalPages ? 'block' : 'none';
            nextBtn.style.display = currentPage === totalPages ? 'none' : 'block';
        }

        function attachAnswerListeners() {
            const radioButtons = questionsContainer.querySelectorAll('input[type="radio"]');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', (event) => {
                    
                    // **புதிய மாற்றம்: ஒரு விருப்பத்தைத் தேர்ந்தெடுத்தவுடன் டைமரைத் தொடங்குங்கள்**
                    if (!isTestStarted) {
                        isTestStarted = true; // தேர்வு தொடங்கிவிட்டது என அமைக்கவும்
                        timerSetup.style.display = 'none'; // நேரத் தேர்வுப் பகுதியை மறைக்கவும்
                        timerRunning.style.display = 'flex'; // இயங்கும் டைமரைக் காட்டவும்
                        startTimer(selectedDuration); // டைமரைத் தொடங்கவும்
                    }
                    
                    const questionIndex = parseInt(event.target.name.substring(1));
                    const selectedOption = parseInt(event.target.value);
                    userAnswers[questionIndex] = selectedOption;
                });
            });
        }
        
        function startTimer(durationInMinutes) {
            let totalSeconds = durationInMinutes * 60;
            
            const initialMinutes = Math.floor(totalSeconds / 60);
            let initialSeconds = totalSeconds % 60;
            initialSeconds = initialSeconds < 10 ? '0' + initialSeconds : initialSeconds;
            timerDisplay.textContent = `${initialMinutes}:${initialSeconds}`;

            timerInterval = setInterval(() => {
                if(isTestSubmitted) {
                    clearInterval(timerInterval);
                    return;
                }
                
                totalSeconds--;
                
                const minutes = Math.floor(totalSeconds / 60);
                let seconds = totalSeconds % 60;
                seconds = seconds < 10 ? '0' + seconds : seconds;
                
                timerDisplay.textContent = `${minutes}:${seconds}`;
                
                if (totalSeconds < 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "0:00";
                    Swal.fire('நேரம் முடிந்தது!', 'உங்கள் தேர்வு தானாகவே சமர்ப்பிக்கப்பட்டது.', 'info');
                    submitTest(true); 
                }
            }, 1000);
        }

        function calculateAndShowResults() {
            isTestSubmitted = true;
            clearInterval(timerInterval);

            let correct = 0;
            let wrong = 0;
            let attended = 0;

            allQuestions.forEach((question, index) => {
                if (userAnswers[index] !== null) {
                    attended++;
                    if (userAnswers[index] === question.correctAnswer) {
                        correct++;
                    } else {
                        wrong++;
                    }
                }
            });

            const score = totalQuestions > 0 ? (correct / totalQuestions) * 100 : 0;

            Swal.fire({
                title: '<strong>தேர்வு முடிவுகள்</strong>',
                icon: 'success',
                html: `
                    <div style="text-align: left; padding-left: 20%;">
                        <p class="results-p"><strong>மொத்த கேள்விகள்:</strong> ${totalQuestions}</p>
                        <p class="results-p"><strong>பதிலளித்தவை:</strong> ${attended}</p>
                        <p class="results-p" style="color: green;"><strong>சரியான பதில்கள்:</strong> ${correct}</p>
                        <p class="results-p" style="color: red;"><strong>தவறான பதில்கள்:</strong> ${wrong}</p>
                        <h3 class="results-h3"><strong>மதிப்பெண்: ${score.toFixed(2)}%</strong></h3>
                    </div>
                `,
                showCloseButton: true,
                showCancelButton: true,
                confirmButtonText: 'மீண்டும் தொடங்கு',
                cancelButtonText: 'நிலை பக்கம் செல்ல',
                focusConfirm: false
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.reload(); 
                } else if (result.dismiss === Swal.DismissReason.cancel) {
                    window.location.href = "plan.html"; 
                }
            });
        }

        function submitTest(isAutoSubmit = false) {
            if (isTestSubmitted) return;

            if(isAutoSubmit) {
                calculateAndShowResults();
                return;
            }

            const unanswered = userAnswers.filter(ans => ans === null).length;
            Swal.fire({
                title: 'தேர்வை முடிக்க விரும்புகிறீர்களா?',
                text: `பதிலளிக்கப்படாத கேள்விகள்: ${unanswered}`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'ஆம், சமர்ப்பி!',
                cancelButtonText: 'இல்லை'
            }).then((result) => {
                if (result.isConfirmed) {
                    calculateAndShowResults();
                }
            });
        }

        prevBtn.addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                displayQuestions();
                testSection.scrollIntoView({ behavior: 'smooth' });
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentPage < totalPages) {
                currentPage++;
                displayQuestions();
                testSection.scrollIntoView({ behavior: 'smooth' });
            }
        });

        submitBtn.addEventListener('click', () => submitTest(false));
        
        timerOptionsGroup.addEventListener('click', (e) => {
            // தேர்வு தொடங்கிய பிறகு நேரத்தை மாற்ற அனுமதிக்க வேண்டாம்
            if(isTestStarted) return;

            const clickedButton = e.target.closest('.timer-option-btn');
            if (!clickedButton) return;

            selectedDuration = parseInt(clickedButton.dataset.time);

            timerOptionsGroup.querySelectorAll('.timer-option-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            clickedButton.classList.add('active');
            timerDisplay.textContent = `${selectedDuration}:00`;
        });
        
        // ஆரம்பத்தில் கேள்விகளைக் காட்டவும்
        displayQuestions();

        window.addEventListener('beforeunload', (event) => {
            if (isTestStarted && !isTestSubmitted) {
                const confirmationMessage = 'நீங்கள் தேர்வை நிறுத்த விரும்புகிறீர்களா? உங்கள் முன்னேற்றம் சேமிக்கப்படாது.';
                event.preventDefault();
                event.returnValue = confirmationMessage;
                return confirmationMessage;
            }
        });
    });
    </script>
</body>
</html>